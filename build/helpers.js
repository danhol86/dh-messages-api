"use strict";
var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.HelperFunctions = void 0;
const { subtle } = require('crypto').webcrypto;
const Blob = require('cross-blob');
const crypto = require("crypto");
class HelperFunctions {
    static ProcessConvData(data) {
        var datare = {
            ConvId: data[0],
            ConvName: data[1],
            LastMsgId: data[16],
            UserId: data[10],
            LastMsgTimeStamp: data[4],
            Recipients: HelperFunctions.ProcessRecipients(data[19]),
            Avatar: data[8] ? Buffer.from(data[8][2]).toString('base64') : null
        };
        return datare;
    }
    static ProcessRecipients(recips) {
        var recipsReturn;
        recipsReturn = [];
        for (var r in recips) {
            var re = recips[r];
            if (re[0][1]) {
                recipsReturn.push({
                    Id: re[0][2],
                    Number: re[0][1],
                });
            }
        }
        return recipsReturn;
    }
    static ProcessMsgData(data, tempIdsSending) {
        var datare = {
            MsgId: data[0],
            MsgTimeStamp: data[4],
            ConvId: data[6],
            UserId: data[8],
            TempId: data[11],
            MsgText: data[9][0][1] ? data[9][0][1][0] : null,
            MsgSubject: data[9][1] ? (data[9][1][1] ? data[9][1][1][0] : null) : null,
            ImageData: data[9][0][2],
            StatusId: data[3][1],
            StatusText: data[3][4],
            MsgSentByUser: (data[3][1] == "1" || data[3][1] == "8" || data[3][1] == "205") ? true : false,
            SentByClient: false
        };
        if (datare.MsgText == null) {
            datare.ImageData[6] = Buffer.from(datare.ImageData[6]).toString('base64');
            datare.ImageData[10] = Buffer.from(datare.ImageData[10]).toString('base64');
            datare.ImageData[11] = Buffer.from(datare.ImageData[11]).toString('base64');
        }
        if (tempIdsSending.indexOf(datare.TempId) >= 0) {
            datare.SentByClient = true;
        }
        return datare;
    }
    static DeCryptMessage2(message, crypto_msg_enc_key) {
        return __awaiter(this, void 0, void 0, function* () {
            var a = message;
            var key = yield subtle.importKey("raw", crypto_msg_enc_key, {
                name: "AES-CTR",
                length: crypto_msg_enc_key.length
            }, !1, ["encrypt", "decrypt"]);
            var c;
            if (48 > a.length)
                throw new RangeError("hc");
            if (null != c)
                throw Error("ic");
            c = new Uint8Array(Array.prototype.slice.call(a, 0, a.length - 32));
            a = new Uint8Array(Array.prototype.slice.call(a, c.length));
            a = new Uint8Array(Array.prototype.slice.call(c, c.length - 16));
            c = new Uint8Array(Array.prototype.slice.call(c, 0, c.length - 16));
            const b = new Uint8Array(16);
            b.set(a);
            let d;
            d = yield subtle.decrypt({
                name: "AES-CTR",
                counter: b,
                length: 128
            }, key, c);
            return new Uint8Array(d);
        });
    }
    static EncryptMessage(message, crypto_msg_enc_key, crypto_msg_hmac) {
        return __awaiter(this, void 0, void 0, function* () {
            message = new Uint8Array(message);
            crypto_msg_enc_key = Buffer.from(crypto_msg_enc_key, 'base64');
            crypto_msg_hmac = Buffer.from(crypto_msg_hmac, 'base64');
            var key = yield subtle.importKey("raw", crypto_msg_enc_key, {
                name: "AES-CTR",
                length: crypto_msg_enc_key.length
            }, !1, ["encrypt", "decrypt"]);
            var hmac = yield subtle.importKey("raw", crypto_msg_hmac, {
                name: "HMAC",
                hash: {
                    name: "SHA-256"
                },
                length: 8 * crypto_msg_hmac.length
            }, !1, ["sign", "verify"]);
            var a = message;
            var c = crypto.randomFillSync(new Uint8Array(16));
            const b = new Uint8Array(16);
            b.set(c);
            var d;
            d = yield subtle.encrypt({
                name: "AES-CTR",
                counter: b,
                length: 128
            }, key, a);
            a = yield HelperFunctions.li([new Uint8Array(d), c]);
            d = yield HelperFunctions.fw(hmac, a);
            if (32 != d.length)
                throw Error("gc`" + d.length);
            return yield HelperFunctions.li([a, d]);
        });
    }
    static li(a) {
        return __awaiter(this, void 0, void 0, function* () {
            var c;
            c = 0;
            for (var b of a)
                c += b.length;
            c = new Uint8Array(c);
            b = 0;
            for (const d of a)
                c.set(d, b),
                    b += d.length;
            return c;
        });
    }
    static fw(hmac, a) {
        return __awaiter(this, void 0, void 0, function* () {
            const b = yield subtle.sign({
                name: "HMAC",
                hash: {
                    name: "SHA-256"
                }
            }, hmac, a);
            return new Uint8Array(b.slice(0, 32));
        });
    }
    static getResponseBuffer(httpresp) {
        var buff = Buffer.from(httpresp);
        var base64string = buff.toString('base64');
        var finalistring = base64string.substring(20, base64string.length - 12);
        if (finalistring.startsWith("Cgo")) {
            finalistring = finalistring.substring(0, finalistring.length - 1) + "=";
        }
        return finalistring;
    }
    static groupBy2(xs, prop) {
        var grouped = {};
        for (var i = 0; i < xs.length; i++) {
            var p = xs[i][prop];
            if (!grouped[p]) {
                grouped[p] = [];
            }
            grouped[p].push(xs[i]);
        }
        return grouped;
    }
    static getKeys() {
        return __awaiter(this, void 0, void 0, function* () {
            var crypto_msg_enc_key = new Uint8Array(32);
            var crypto_msg_hmac = new Uint8Array(32);
            crypto.randomFillSync(crypto_msg_enc_key);
            crypto.randomFillSync(crypto_msg_hmac);
            var ECDSA_Keys = yield subtle.generateKey({
                name: "ECDSA",
                namedCurve: "P-256"
            }, true, ["sign"]);
            return {
                crypto_msg_enc_key,
                crypto_msg_hmac,
                ECDSA_Keys
            };
        });
    }
    static GetRefreshToken(privkey, pubkey, refreqid, utimestamp) {
        return __awaiter(this, void 0, void 0, function* () {
            var privkeysjson = Buffer.from(privkey, 'base64').toString();
            var privobj = JSON.parse(privkeysjson);
            var pubkeysjson = Buffer.from(pubkey, 'base64').toString();
            var pubobj = JSON.parse(pubkeysjson);
            var keydata = {
                kty: "EC",
                crv: "P-256",
                x: pubobj.x,
                y: pubobj.y,
                d: privobj.d
            };
            const blobb = new Blob([`${refreqid}:${utimestamp}`]);
            const arrbuffer = yield blobb.arrayBuffer();
            const blogbuff = Buffer.from(arrbuffer);
            const d = new Uint8Array(blogbuff);
            var mykeysign = yield subtle.importKey("jwk", keydata, {
                name: "ECDSA",
                namedCurve: "P-256"
            }, !0, ["sign"]);
            var msgsign = yield subtle.sign({
                name: "ECDSA",
                hash: {
                    name: "SHA-256"
                }
            }, mykeysign, d);
            var b64sign = new Uint8Array(msgsign);
            b64sign = HelperFunctions.EncodeUINT(msgsign);
            var encstr = Buffer.from(b64sign).toString('base64');
            return encstr;
        });
    }
    static EncodeUINT(c) {
        var b = new Uint8Array(c);
        if (0 != b.length % 2 || 0 == b.length || 132 < b.length)
            throw "Invalid IEEE P1363 signature encoding. Length: " + b.length;
        c = HelperFunctions.Oha(b.subarray(0, b.length / 2));
        b = HelperFunctions.Oha(b.subarray(b.length / 2, b.length));
        let d = 0;
        const e = c.length + 4 + b.length;
        let f;
        128 <= e ? (f = new Uint8Array(e + 3),
            f[d++] = 48,
            f[d++] = 129) : (f = new Uint8Array(e + 2),
            f[d++] = 48);
        f[d++] = e;
        f[d++] = 2;
        f[d++] = c.length;
        f.set(c, d);
        d += c.length;
        f[d++] = 2;
        f[d++] = b.length;
        f.set(b, d);
        c = f;
        return c;
    }
}
exports.HelperFunctions = HelperFunctions;
HelperFunctions.Oha = function (a) {
    let c = 0;
    for (; c < a.length && 0 == a[c];)
        c++;
    c == a.length && (c = a.length - 1);
    let b = 0;
    128 == (a[c] & 128) && (b = 1);
    const d = new Uint8Array(a.length - c + b);
    d.set(a.subarray(c), b);
    return d;
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaGVscGVycy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uL3NyYy9oZWxwZXJzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7OztBQUFBLE1BQU0sRUFBRSxNQUFNLEVBQUUsR0FBRyxPQUFPLENBQUMsUUFBUSxDQUFDLENBQUMsU0FBUyxDQUFDO0FBQy9DLE1BQU0sSUFBSSxHQUFHLE9BQU8sQ0FBQyxZQUFZLENBQUMsQ0FBQztBQUNuQyxpQ0FBaUM7QUFFakMsTUFBYSxlQUFlO0lBRXhCLE1BQU0sQ0FBQyxlQUFlLENBQUMsSUFBSTtRQUN2QixJQUFJLE1BQU0sR0FBRztZQUNULE1BQU0sRUFBRyxJQUFJLENBQUMsQ0FBQyxDQUFDO1lBQ2hCLFFBQVEsRUFBRyxJQUFJLENBQUMsQ0FBQyxDQUFDO1lBQ2xCLFNBQVMsRUFBRyxJQUFJLENBQUMsRUFBRSxDQUFDO1lBQ3BCLE1BQU0sRUFBRyxJQUFJLENBQUMsRUFBRSxDQUFDO1lBQ2pCLGdCQUFnQixFQUFFLElBQUksQ0FBQyxDQUFDLENBQUM7WUFDekIsVUFBVSxFQUFFLGVBQWUsQ0FBQyxpQkFBaUIsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUM7WUFDdkQsTUFBTSxFQUFFLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxRQUFRLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUk7U0FDdEUsQ0FBQztRQUVGLE9BQU8sTUFBTSxDQUFDO0lBQ2xCLENBQUM7SUFFTyxNQUFNLENBQUMsaUJBQWlCLENBQUMsTUFBTTtRQUNuQyxJQUFJLFlBQVksQ0FBQztRQUFDLFlBQVksR0FBRyxFQUFFLENBQUM7UUFDcEMsS0FBSSxJQUFJLENBQUMsSUFBSSxNQUFNLEVBQUU7WUFDakIsSUFBSSxFQUFFLEdBQUcsTUFBTSxDQUFDLENBQUMs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